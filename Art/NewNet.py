import networkx as nx
from networkx.algorithms import bipartite
import numpy as np
from scipy.spatial import distance_matrix
from scipy.optimize import linear_sum_assignment
import sys
import matplotlib.pyplot as plt
# from postman_problems.solver import cpp
# from postman_problems.stats import calculate_postman_solution_stats
import itertools
import atexit
from tempfile import TemporaryFile
import time
# import pandas as pd

print('Line done')
cities = [[173, 83], [174, 83], [175, 83], [176, 83], [224, 83], [168, 84], [169, 84], [170, 84], [171, 84], [179, 84], [180, 84], [181, 84], [214, 84], [215, 84], [226, 84], [227, 84], [228, 84], [229, 84], [119, 85], [120, 85], [129, 85], [130, 85], [131, 85], [132, 85], [165, 85], [166, 85], [167, 85], [183, 85], [184, 85], [185, 85], [210, 85], [212, 85], [230, 85], [231, 85], [232, 85], [256, 85], [257, 85], [258, 85], [265, 85], [266, 85], [267, 85], [116, 86], [117, 86], [134, 86], [135, 86], [136, 86], [162, 86], [163, 86], [164, 86], [186, 86], [187, 86], [188, 86], [208, 86], [210, 86], [233, 86], [234, 86], [235, 86], [252, 86], [253, 86], [254, 86], [269, 86], [270, 86], [113, 87], [114, 87], [115, 87], [137, 87], [138, 87], [139, 87], [159, 87], [160, 87], [161, 87], [189, 87], [190, 87], [191, 87], [204, 87], [205, 87], [206, 87], [207, 87], [238, 87], [240, 87], [250, 87], [251, 87], [271, 87], [272, 87], [273, 87], [288, 87], [289, 87], [290, 87], [291, 87], [292, 87], [293, 87], [294, 87], [295, 87], [110, 88], [111, 88], [112, 88], [140, 88], [141, 88], [142, 88], [143, 88], [155, 88], [156, 88], [157, 88], [158, 88], [192, 88], [193, 88], [194, 88], [201, 88], [202, 88], [203, 88], [240, 88], [274, 88], [275, 88], [276, 88], [277, 88], [287, 88], [296, 88], [106, 89], [107, 89], [108, 89], [109, 89], [147, 89], [148, 89], [149, 89], [150, 89], [151, 89], [152, 89], [297, 89], [ 87, 90], [ 88, 90], [ 89, 90], [ 90, 90], [ 91, 90], [ 92, 90], [ 99, 90], [100, 90], [101, 90], [102, 90], [103, 90], [104, 90], [105, 90], [298, 90], [ 84, 91], [ 85, 91], [299, 91], [ 83, 92], [299, 92], [ 77, 93], [ 77, 94], [300, 94], [ 80, 95], [ 78, 96], [ 78, 97], [ 79, 98], [ 77, 99], [ 80, 99], [117, 99], [118, 99], [119, 99], [120, 99], [121, 99], [122, 99], [ 76,100], [114,100], [115,100], [124,100], [300,100], [ 75,101], [ 81,101], [113,101], [125,101], [300,101], [ 74,102], [158,102], [300,102], [ 74,103], [ 82,103], [109,103], [127,103], [160,103], [162,103], [163,103], [164,103], [165,103], [300,103], [ 73,104], [ 82,104], [128,104], [160,104], [167,104], [168,104], [169,104], [170,104], [274,104], [275,104], [276,104], [280,104], [281,104], [283,104], [300,104], [ 73,105], [ 83,105], [108,105], [109,105], [172,105], [173,105], [174,105], [283,105], [ 72,106], [ 83,106], [129,106], [176,106], [177,106], [178,106], [299,106], [ 72,107], [ 84,107], [107,107], [129,107], [179,107], [180,107], [181,107], [283,107], [299,107], [ 71,108], [ 84,108], [107,108], [129,108], [182,108], [183,108], [283,108], [ 85,109], [107,109], [129,109], [184,109], [185,109], [186,109], [272,109], [283,109], [298,109], [ 70,110], [107,110], [129,110], [188,110], [189,110], [272,110], [283,110], [298,110], [ 69,111], [ 86,111], [107,111], [129,111], [271,111], [283,111], [297,111], [ 69,112], [ 87,112], [107,112], [271,112], [297,112], [ 68,113], [ 87,113], [107,113], [128,113], [191,113], [271,113], [282,113], [283,113], [297,113], [ 67,114], [107,114], [192,114], [271,114], [297,114], [ 88,115], [107,115], [127,115], [193,115], [272,115], [ 64,116], [ 88,116], [108,116], [126,116], [272,116], [280,116], [ 62,117], [ 88,117], [109,117], [273,117], [297,117], [ 60,118], [ 62,118], [ 88,118], [124,118], [275,118], [276,118], [277,118], [279,118], [280,118], [297,118], [ 58,119], [ 60,119], [ 88,119], [109,119], [111,119], [112,119], [123,119], [163,119], [165,119], [166,119], [167,119], [168,119], [169,119], [170,119], [171,119], [172,119], [173,119], [174,119], [175,119], [176,119], [297,119], [ 56,120], [ 88,120], [113,120], [114,120], [115,120], [116,120], [117,120], [118,120], [119,120], [159,120], [160,120], [161,120], [163,120], [177,120], [178,120], [179,120], [180,120], [240,120], [241,120], [242,120], [243,120], [244,120], [245,120], [298,120], [ 88,121], [156,121], [157,121], [158,121], [181,121], [182,121], [247,121], [248,121], [249,121], [298,121], [ 88,122], [154,122], [155,122], [184,122], [185,122], [250,122], [251,122], [ 88,123], [152,123], [153,123], [186,123], [187,123], [253,123], [299,123], [ 88,124], [151,124], [188,124], [254,124], [255,124], [299,124], [ 88,125], [149,125], [189,125], [190,125], [256,125], [300,125], [148,126], [191,126], [218,126], [257,126], [258,126], [300,126], [ 50,127], [ 51,127], [ 87,127], [147,127], [192,127], [217,127], [259,127], [300,127], [ 87,128], [146,128], [193,128], [216,128], [260,128], [ 49,129], [ 50,129], [ 69,129], [ 70,129], [ 71,129], [ 72,129], [ 73,129], [ 87,129], [194,129], [215,129], [261,129], [301,129], [ 67,130], [ 68,130], [ 74,130], [ 75,130], [ 87,130], [195,130], [212,130], [214,130], [262,130], [301,130], [ 48,131], [ 49,131], [ 66,131], [ 76,131], [196,131], [263,131], [301,131], [ 63,132], [ 65,132], [ 77,132], [ 88,132], [108,132], [109,132], [110,132], [142,132], [197,132], [264,132], [301,132], [ 47,133], [ 78,133], [ 80,133], [ 88,133], [111,133], [141,133], [198,133], [266,133], [301,133], [ 47,134], [ 63,134], [ 88,134], [140,134], [199,134], [265,134], [301,134], [ 46,135], [ 62,135], [ 89,135], [113,135], [200,135], [266,135], [267,135], [301,135], [ 62,136], [ 89,136], [113,136], [139,136], [201,136], [205,136], [ 61,137], [113,137], [138,137], [201,137], [208,137], [267,137], [300,137], [ 81,138], [ 90,138], [113,138], [201,138], [206,138], [267,138], [300,138], [ 60,139], [ 91,139], [137,139], [171,139], [172,139], [173,139], [300,139], [ 60,140], [ 82,140], [ 91,140], [106,140], [113,140], [175,140], [176,140], [177,140], [178,140], [179,140], [180,140], [181,140], [182,140], [183,140], [184,140], [185,140], [186,140], [187,140], [188,140], [189,140], [190,140], [191,140], [202,140], [206,140], [ 59,141], [ 82,141], [ 92,141], [109,141], [136,141], [171,141], [192,141], [193,141], [194,141], [195,141], [196,141], [203,141], [204,141], [299,141], [ 39,142], [ 59,142], [ 82,142], [ 92,142], [106,142], [109,142], [197,142], [205,142], [235,142], [236,142], [237,142], [238,142], [239,142], [240,142], [241,142], [242,142], [243,142], [244,142], [245,142], [246,142], [247,142], [248,142], [249,142], [250,142], [251,142], [252,142], [253,142], [254,142], [258,142], [259,142], [260,142], [261,142], [299,142], [ 38,143], [ 59,143], [ 93,143], [135,143], [206,143], [271,143], [ 34,144], [ 37,144], [ 59,144], [ 83,144], [ 94,144], [298,144], [ 36,145], [ 58,145], [ 83,145], [ 94,145], [134,145], [273,145], [298,145], [ 58,146], [ 83,146], [ 95,146], [208,146], [273,146], [298,146], [ 34,147], [ 58,147], [ 83,147], [ 95,147], [208,147], [273,147], [ 58,148], [ 83,148], [ 96,148], [ 33,149], [ 58,149], [ 83,149], [211,149], [238,149], [239,149], [240,149], [241,149], [242,149], [243,149], [244,149], [273,149], [297,149], [ 33,150], [ 58,150], [ 83,150], [ 96,150], [ 97,150], [210,150], [234,150], [247,150], [248,150], [250,150], [251,150], [252,150], [253,150], [257,150], [258,150], [259,150], [260,150], [261,150], [262,150], [263,150], [264,150], [265,150], [266,150], [272,150], [297,150], [ 33,151], [ 58,151], [ 83,151], [209,151], [215,151], [216,151], [217,151], [218,151], [219,151], [223,151], [224,151], [225,151], [226,151], [227,151], [228,151], [231,151], [232,151], [255,151], [256,151], [271,151], [297,151], [ 33,152], [ 58,152], [ 83,152], [ 97,152], [208,152], [211,152], [214,152], [233,152], [248,152], [270,152], [297,152], [ 58,153], [ 83,153], [ 97,153], [172,153], [173,153], [174,153], [175,153], [176,153], [177,153], [178,153], [179,153], [180,153], [185,153], [186,153], [187,153], [188,153], [189,153], [190,153], [191,153], [193,153], [194,153], [195,153], [196,153], [197,153], [198,153], [199,153], [200,153], [201,153], [202,153], [203,153], [204,153], [ 33,154], [ 58,154], [ 97,154], [159,154], [160,154], [161,154], [162,154], [163,154], [166,154], [167,154], [169,154], [182,154], [183,154], [184,154], [192,154], [247,154], [ 33,155], [ 58,155], [ 82,155], [ 97,155], [147,155], [148,155], [149,155], [150,155], [151,155], [152,155], [153,155], [158,155], [205,155], [254,155], [298,155], [ 33,156], [ 58,156], [ 82,156], [ 97,156], [141,156], [142,156], [143,156], [144,156], [145,156], [166,156], [167,156], [205,156], [235,156], [248,156], [254,156], [271,156], [298,156], [ 58,157], [ 82,157], [ 97,157], [130,157], [137,157], [138,157], [139,157], [170,157], [205,157], [237,157], [243,157], [244,157], [253,157], [271,157], [298,157], [ 34,158], [ 58,158], [ 82,158], [ 97,158], [132,158], [136,158], [160,158], [180,158], [190,158], [205,158], [227,158], [237,158], [239,158], [240,158], [241,158], [253,158], [271,158], [ 35,159], [ 82,159], [ 97,159], [133,159], [160,159], [172,159], [179,159], [190,159], [205,159], [228,159], [270,159], [299,159], [ 35,160], [ 59,160], [ 81,160], [ 97,160], [134,160], [174,160], [175,160], [176,160], [177,160], [180,160], [181,160], [229,160], [251,160], [270,160], [299,160], [ 36,161], [ 59,161], [ 81,161], [ 97,161], [133,161], [161,161], [189,161], [230,161], [270,161], [299,161], [ 37,162], [ 59,162], [ 81,162], [ 97,162], [161,162], [300,162], [ 60,163], [ 80,163], [ 97,163], [163,163], [187,163], [230,163], [232,163], [233,163], [247,163], [300,163], [ 38,164], [ 60,164], [ 80,164], [ 97,164], [164,164], [187,164], [188,164], [205,164], [234,164], [235,164], [236,164], [244,164], [245,164], [246,164], [300,164], [ 39,165], [ 61,165], [ 79,165], [135,165], [165,165], [184,165], [185,165], [237,165], [238,165], [239,165], [240,165], [241,165], [242,165], [300,165], [ 40,166], [ 61,166], [ 79,166], [ 98,166], [135,166], [167,166], [182,166], [207,166], [268,166], [ 41,167], [ 43,167], [ 98,167], [136,167], [169,167], [170,167], [176,167], [177,167], [178,167], [179,167], [180,167], [203,167], [265,167], [266,167], [269,167], [271,167], [301,167], [ 42,168], [ 77,168], [ 98,168], [136,168], [202,168], [260,168], [261,168], [262,168], [263,168], [273,168], [301,168], [ 99,169], [202,169], [209,169], [256,169], [257,169], [258,169], [274,169], [275,169], [279,169], [301,169], [ 43,170], [ 99,170], [137,170], [201,170], [254,170], [255,170], [276,170], [279,170], [301,170], [ 44,171], [ 66,171], [ 74,171], [100,171], [201,171], [210,171], [252,171], [253,171], [277,171], [301,171], [ 45,172], [ 68,172], [ 69,172], [ 70,172], [ 71,172], [ 72,172], [100,172], [138,172], [200,172], [211,172], [250,172], [278,172], [301,172], [ 45,173], [101,173], [139,173], [248,173], [279,173], [301,173], [ 46,174], [101,174], [139,174], [199,174], [212,174], [246,174], [279,174], [301,174], [ 46,175], [102,175], [140,175], [198,175], [213,175], [244,175], [280,175], [301,175], [ 46,176], [141,176], [214,176], [242,176], [280,176], [142,177], [215,177], [240,177], [280,177], [300,177], [ 47,178], [143,178], [216,178], [237,178], [238,178], [280,178], [300,178], [ 47,179], [144,179], [217,179], [235,179], [236,179], [280,179], [300,179], [ 47,180], [145,180], [218,180], [232,180], [233,180], [234,180], [280,180], [ 47,181], [146,181], [193,181], [220,181], [229,181], [230,181], [299,181], [ 47,182], [107,182], [147,182], [192,182], [221,182], [224,182], [225,182], [226,182], [227,182], [279,182], [299,182], [107,183], [148,183], [190,183], [219,183], [223,183], [279,183], [299,183], [149,184], [150,184], [189,184], [218,184], [278,184], [298,184], [108,185], [151,185], [187,185], [216,185], [298,185], [ 48,186], [109,186], [153,186], [185,186], [186,186], [298,186], [ 48,187], [109,187], [155,187], [156,187], [182,187], [183,187], [297,187], [ 48,188], [109,188], [157,188], [158,188], [159,188], [179,188], [180,188], [181,188], [275,188], [297,188], [ 48,189], [ 66,189], [ 69,189], [ 70,189], [ 71,189], [109,189], [160,189], [161,189], [162,189], [163,189], [164,189], [174,189], [175,189], [176,189], [177,189], [178,189], [274,189], [277,189], [297,189], [ 48,190], [109,190], [165,190], [166,190], [167,190], [168,190], [169,190], [170,190], [171,190], [172,190], [272,190], [297,190], [ 48,191], [ 67,191], [ 73,191], [109,191], [270,191], [272,191], [ 49,192], [ 66,192], [109,192], [268,192], [269,192], [ 49,193], [ 66,193], [109,193], [265,193], [266,193], [267,193], [ 49,194], [ 65,194], [ 74,194], [109,194], [262,194], [263,194], [264,194], [ 50,195], [ 65,195], [ 74,195], [109,195], [258,195], [259,195], [260,195], [261,195], [297,195], [ 65,196], [ 74,196], [ 91,196], [ 92,196], [ 93,196], [ 94,196], [109,196], [219,196], [253,196], [254,196], [255,196], [256,196], [257,196], [297,196], [ 51,197], [ 65,197], [ 74,197], [ 95,197], [ 96,197], [109,197], [221,197], [222,197], [223,197], [224,197], [249,197], [250,197], [251,197], [297,197], [ 52,198], [ 65,198], [ 73,198], [ 89,198], [ 97,198], [ 99,198], [109,198], [228,198], [229,198], [230,198], [231,198], [232,198], [233,198], [234,198], [235,198], [236,198], [237,198], [238,198], [239,198], [240,198], [241,198], [242,198], [247,198], [ 65,199], [ 73,199], [109,199], [298,199], [ 53,200], [ 65,200], [ 73,200], [ 87,200], [ 99,200], [109,200], [298,200], [ 54,201], [ 66,201], [ 72,201], [ 86,201], [ 99,201], [109,201], [274,201], [298,201], [ 55,202], [ 71,202], [ 85,202], [100,202], [109,202], [275,202], [300,202], [ 68,203], [ 69,203], [ 70,203], [ 85,203], [100,203], [109,203], [299,203], [ 56,204], [ 66,204], [ 67,204], [ 84,204], [101,204], [247,204], [274,204], [276,204], [ 57,205], [ 84,205], [101,205], [110,205], [249,205], [263,205], [267,205], [300,205], [301,205], [ 58,206], [ 84,206], [101,206], [110,206], [264,206], [266,206], [ 58,207], [ 83,207], [101,207], [110,207], [166,207], [167,207], [249,207], [300,207], [ 59,208], [ 83,208], [101,208], [111,208], [249,208], [264,208], [266,208], [ 59,209], [ 83,209], [102,209], [111,209], [166,209], [168,209], [249,209], [263,209], [301,209], [ 60,210], [ 83,210], [102,210], [111,210], [249,210], [301,210], [ 60,211], [ 83,211], [102,211], [112,211], [251,211], [301,211], [ 61,212], [ 83,212], [102,212], [112,212], [301,212], [ 61,213], [ 83,213], [113,213], [170,213], [233,213], [234,213], [235,213], [236,213], [237,213], [238,213], [239,213], [240,213], [241,213], [242,213], [243,213], [244,213], [245,213], [247,213], [301,213], [ 61,214], [ 83,214], [101,214], [113,214], [170,214], [173,214], [230,214], [231,214], [247,214], [301,214], [ 62,215], [ 83,215], [101,215], [114,215], [171,215], [222,215], [223,215], [224,215], [225,215], [227,215], [228,215], [300,215], [ 62,216], [ 83,216], [101,216], [114,216], [171,216], [213,216], [215,216], [216,216], [221,216], [300,216], [ 62,217], [ 83,217], [101,217], [115,217], [173,217], [209,217], [210,217], [211,217], [213,217], [300,217], [ 62,218], [ 83,218], [101,218], [115,218], [206,218], [207,218], [247,218], [299,218], [ 62,219], [ 83,219], [100,219], [116,219], [204,219], [205,219], [247,219], [299,219], [ 62,220], [ 83,220], [100,220], [116,220], [198,220], [199,220], [203,220], [220,220], [247,220], [100,221], [117,221], [201,221], [220,221], [228,221], [248,221], [298,221], [ 84,222], [ 99,222], [117,222], [221,222], [228,222], [248,222], [298,222], [ 84,223], [221,223], [228,223], [248,223], [ 85,224], [ 98,224], [118,224], [221,224], [228,224], [248,224], [297,224], [ 85,225], [118,225], [221,225], [228,225], [248,225], [278,225], [279,225], [280,225], [281,225], [282,225], [283,225], [297,225], [ 86,226], [118,226], [202,226], [221,226], [228,226], [248,226], [275,226], [276,226], [284,226], [285,226], [ 63,227], [ 87,227], [119,227], [137,227], [138,227], [139,227], [140,227], [142,227], [202,227], [221,227], [228,227], [248,227], [274,227], [286,227], [288,227], [ 63,228], [ 88,228], [ 95,228], [119,228], [134,228], [136,228], [202,228], [221,228], [228,228], [248,228], [296,228], [ 63,229], [ 86,229], [ 89,229], [ 90,229], [ 91,229], [ 92,229], [ 93,229], [ 95,229], [119,229], [134,229], [202,229], [221,229], [229,229], [272,229], [296,229], [ 64,230], [119,230], [142,230], [203,230], [230,230], [234,230], [235,230], [236,230], [237,230], [238,230], [244,230], [245,230], [248,230], [271,230], [288,230], [296,230], [ 64,231], [119,231], [133,231], [143,231], [205,231], [218,231], [220,231], [227,231], [228,231], [249,231], [270,231], [289,231], [296,231], [ 64,232], [119,232], [133,232], [143,232], [203,232], [206,232], [207,232], [208,232], [209,232], [210,232], [211,232], [212,232], [213,232], [214,232], [215,232], [216,232], [217,232], [222,232], [269,232], [289,232], [297,232], [ 65,233], [119,233], [132,233], [143,233], [269,233], [289,233], [297,233], [ 65,234], [119,234], [132,234], [143,234], [268,234], [289,234], [297,234], [ 66,235], [119,235], [132,235], [142,235], [268,235], [289,235], [297,235], [119,236], [133,236], [142,236], [268,236], [289,236], [297,236], [ 67,237], [119,237], [133,237], [250,237], [268,237], [289,237], [297,237], [ 68,238], [119,238], [134,238], [193,238], [249,238], [268,238], [289,238], [ 68,239], [138,239], [139,239], [194,239], [268,239], [289,239], [ 69,240], [ 88,240], [ 89,240], [133,240], [140,240], [195,240], [268,240], [288,240], [ 70,241], [197,241], [246,241], [268,241], [288,241], [298,241], [ 70,242], [ 90,242], [ 91,242], [198,242], [224,242], [225,242], [226,242], [231,242], [232,242], [233,242], [234,242], [244,242], [245,242], [287,242], [298,242], [ 71,243], [ 83,243], [119,243], [200,243], [220,243], [221,243], [222,243], [235,243], [236,243], [237,243], [238,243], [239,243], [240,243], [241,243], [242,243], [269,243], [286,243], [ 83,244], [ 91,244], [119,244], [200,244], [202,244], [203,244], [204,244], [216,244], [217,244], [218,244], [219,244], [270,244], [286,244], [ 72,245], [ 91,245], [119,245], [205,245], [206,245], [207,245], [208,245], [209,245], [210,245], [211,245], [212,245], [213,245], [214,245], [ 82,246], [ 91,246], [156,246], [157,246], [158,246], [159,246], [160,246], [161,246], [270,246], [272,246], [282,246], [283,246], [297,246], [ 73,247], [ 82,247], [ 91,247], [120,247], [154,247], [162,247], [163,247], [165,247], [273,247], [274,247], [275,247], [276,247], [277,247], [278,247], [279,247], [280,247], [281,247], [297,247], [ 82,248], [ 91,248], [120,248], [152,248], [297,248], [ 74,249], [ 82,249], [ 91,249], [122,249], [150,249], [165,249], [ 74,250], [ 82,250], [150,250], [296,250], [297,250], [ 75,251], [ 90,251], [122,251], [149,251], [166,251], [ 75,252], [ 83,252], [148,252], [296,252], [ 75,253], [ 84,253], [ 88,253], [123,253], [167,253], [259,253], [260,253], [261,253], [262,253], [ 76,254], [ 86,254], [124,254], [147,254], [167,254], [256,254], [257,254], [263,254], [265,254], [295,254], [ 76,255], [ 86,255], [167,255], [146,256], [167,256], [295,256], [146,257], [167,257], [255,257], [265,257], [125,258], [126,258], [146,258], [167,258], [255,258], [265,258], [294,258], [297,258], [ 77,259], [146,259], [167,259], [255,259], [298,259], [126,260], [146,260], [255,260], [264,260], [ 78,261], [ 81,261], [ 82,261], [ 83,261], [ 84,261], [ 87,261], [ 88,261], [127,261], [146,261], [166,261], [256,261], [ 78,262], [ 79,262], [ 89,262], [127,262], [146,262], [166,262], [257,262], [262,262], [264,262], [299,262], [ 90,263], [ 92,263], [127,263], [147,263], [165,263], [259,263], [260,263], [261,263], [ 78,264], [127,264], [147,264], [294,264], [300,264], [ 92,265], [127,265], [148,265], [294,265], [300,265], [ 77,266], [ 93,266], [127,266], [149,266], [300,266], [ 93,267], [127,267], [161,267], [293,267], [ 76,268], [ 94,268], [149,268], [151,268], [152,268], [159,268], [160,268], [301,268], [ 76,269], [ 94,269], [153,269], [154,269], [155,269], [156,269], [157,269], [301,269], [ 75,270], [ 95,270], [293,270], [301,270], [ 75,271], [ 95,271], [292,271], [301,271], [ 75,272], [127,272], [273,272], [274,272], [275,272], [276,272], [277,272], [278,272], [280,272], [291,272], [301,272], [ 96,273], [127,273], [239,273], [240,273], [241,273], [242,273], [245,273], [270,273], [271,273], [272,273], [280,273], [282,273], [283,273], [284,273], [285,273], [286,273], [290,273], [301,273], [ 74,274], [ 96,274], [127,274], [237,274], [247,274], [267,274], [268,274], [269,274], [289,274], [301,274], [ 74,275], [ 97,275], [127,275], [193,275], [194,275], [195,275], [196,275], [197,275], [228,275], [229,275], [251,275], [252,275], [264,275], [265,275], [266,275], [301,275], [ 74,276], [ 97,276], [127,276], [186,276], [187,276], [188,276], [189,276], [190,276], [199,276], [200,276], [201,276], [202,276], [203,276], [224,276], [225,276], [226,276], [227,276], [254,276], [255,276], [260,276], [261,276], [301,276], [ 73,277], [ 98,277], [102,277], [182,277], [183,277], [205,277], [206,277], [220,277], [221,277], [222,277], [223,277], [236,277], [257,277], [258,277], [301,277], [ 73,278], [ 98,278], [104,278], [105,278], [106,278], [107,278], [108,278], [109,278], [110,278], [111,278], [112,278], [113,278], [114,278], [115,278], [116,278], [143,278], [144,278], [145,278], [146,278], [147,278], [148,278], [180,278], [181,278], [208,278], [212,278], [213,278], [214,278], [215,278], [216,278], [217,278], [218,278], [233,278], [237,278], [255,278], [289,278], [300,278], [ 73,279], [ 98,279], [117,279], [118,279], [127,279], [138,279], [139,279], [140,279], [141,279], [150,279], [151,279], [152,279], [178,279], [210,279], [238,279], [ 73,280], [119,280], [120,280], [136,280], [137,280], [154,280], [155,280], [156,280], [169,280], [170,280], [171,280], [172,280], [176,280], [212,280], [233,280], [240,280], [290,280], [299,280], [122,281], [127,281], [128,281], [132,281], [133,281], [158,281], [159,281], [160,281], [161,281], [162,281], [163,281], [164,281], [165,281], [166,281], [177,281], [233,281], [241,281], [292,281], [ 72,282], [122,282], [124,282], [125,282], [130,282], [179,282], [206,282], [233,282], [294,282], [295,282], [296,282], [ 72,283], [ 98,283], [132,283], [206,283], [290,283], [ 72,284], [ 98,284], [182,284], [183,284], [205,284], [232,284], [244,284], [251,284], [290,284], [ 72,285], [185,285], [186,285], [232,285], [245,285], [248,285], [249,285], [ 71,286], [ 99,286], [187,286], [188,286], [214,286], [246,286], [247,286], [ 71,287], [ 99,287], [190,287], [215,287], [244,287], [296,287], [ 71,288], [ 99,288], [131,288], [193,288], [216,288], [296,288], [ 71,289], [ 99,289], [131,289], [195,289], [196,289], [197,289], [217,289], [218,289], [229,289], [296,289], [ 71,290], [ 99,290], [131,290], [199,290], [201,290], [228,290], [289,290], [ 71,291], [131,291], [216,291], [228,291], [278,291], [279,291], [280,291], [281,291], [282,291], [283,291], [284,291], [289,291], [100,292], [131,292], [216,292], [259,292], [260,292], [261,292], [262,292], [263,292], [264,292], [265,292], [266,292], [267,292], [268,292], [269,292], [270,292], [271,292], [272,292], [273,292], [274,292], [276,292], [289,292], [297,292], [100,293], [131,293], [251,293], [252,293], [253,293], [254,293], [255,293], [256,293], [257,293], [297,293], [ 70,294], [100,294], [131,294], [215,294], [230,294], [234,294], [290,294], [297,294], [ 70,295], [101,295], [105,295], [131,295], [231,295], [232,295], [290,295], [297,295], [107,296], [108,296], [109,296], [110,296], [196,296], [197,296], [198,296], [199,296], [200,296], [201,296], [202,296], [203,296], [204,296], [205,296], [206,296], [207,296], [208,296], [213,296], [290,296], [297,296], [ 71,297], [100,297], [112,297], [113,297], [114,297], [115,297], [116,297], [181,297], [182,297], [183,297], [184,297], [185,297], [186,297], [187,297], [188,297], [189,297], [190,297], [191,297], [192,297], [193,297], [213,297], [232,297], [253,297], [273,297], [274,297], [275,297], [276,297], [277,297], [278,297], [279,297], [280,297], [290,297], [297,297], [ 71,298], [100,298], [118,298], [119,298], [120,298], [121,298], [122,298], [166,298], [167,298], [168,298], [169,298], [170,298], [171,298], [172,298], [173,298], [174,298], [175,298], [176,298], [177,298], [178,298], [179,298], [262,298], [266,298], [267,298], [268,298], [269,298], [270,298], [271,298], [272,298], [282,298], [284,298], [290,298], [297,298], [ 71,299], [100,299], [124,299], [125,299], [126,299], [127,299], [128,299], [129,299], [130,299], [149,299], [150,299], [151,299], [152,299], [153,299], [154,299], [155,299], [156,299], [157,299], [158,299], [159,299], [160,299], [161,299], [162,299], [163,299], [164,299], [212,299], [233,299], [236,299], [237,299], [238,299], [239,299], [245,299], [246,299], [247,299], [248,299], [249,299], [250,299], [253,299], [264,299], [290,299], [295,299], [297,299], [ 72,300], [134,300], [135,300], [136,300], [137,300], [138,300], [139,300], [140,300], [141,300], [142,300], [143,300], [144,300], [145,300], [146,300], [147,300], [148,300], [234,300], [251,300], [283,300], [290,300], [297,300], [252,301], [263,301], [283,301], [290,301], [297,301], [ 71,302], [101,302], [186,302], [197,302], [198,302], [199,302], [200,302], [201,302], [202,302], [203,302], [204,302], [205,302], [206,302], [211,302], [252,302], [263,302], [283,302], [290,302], [297,302], [ 76,303], [ 77,303], [ 99,303], [190,303], [191,303], [192,303], [193,303], [194,303], [195,303], [210,303], [252,303], [263,303], [290,303], [297,303], [ 79,304], [ 80,304], [ 95,304], [107,304], [108,304], [109,304], [110,304], [176,304], [186,304], [188,304], [209,304], [235,304], [252,304], [263,304], [290,304], [297,304], [ 82,305], [ 84,305], [ 85,305], [ 91,305], [ 93,305], [ 97,305], [ 98,305], [111,305], [112,305], [113,305], [114,305], [115,305], [121,305], [152,305], [153,305], [154,305], [155,305], [156,305], [157,305], [158,305], [159,305], [160,305], [161,305], [162,305], [163,305], [164,305], [165,305], [166,305], [167,305], [168,305], [169,305], [170,305], [171,305], [172,305], [175,305], [209,305], [252,305], [279,305], [282,305], [290,305], [297,305], [ 83,306], [117,306], [131,306], [147,306], [150,306], [173,306], [236,306], [249,306], [253,306], [264,306], [266,306], [268,306], [269,306], [270,306], [271,306], [272,306], [273,306], [274,306], [275,306], [276,306], [277,306], [279,306], [280,306], [290,306], [297,306], [ 92,307], [118,307], [120,307], [131,307], [174,307], [187,307], [208,307], [237,307], [239,307], [240,307], [241,307], [242,307], [243,307], [244,307], [245,307], [246,307], [247,307], [250,307], [254,307], [262,307], [290,307], [297,307], [ 82,308], [ 92,308], [105,308], [131,308], [147,308], [174,308], [187,308], [238,308], [290,308], [297,308], [107,309], [108,309], [109,309], [110,309], [119,309], [131,309], [147,309], [187,309], [208,309], [290,309], [297,309], [ 93,310], [111,310], [112,310], [113,310], [114,310], [118,310], [131,310], [147,310], [186,310], [189,310], [192,310], [193,310], [194,310], [195,310], [196,310], [197,310], [198,310], [199,310], [200,310], [201,310], [202,310], [203,310], [206,310], [236,310], [290,310], [297,310], [ 83,311], [ 93,311], [115,311], [116,311], [117,311], [120,311], [131,311], [148,311], [173,311], [185,311], [206,311], [290,311], [297,311], [ 83,312], [ 93,312], [121,312], [131,312], [149,312], [150,312], [151,312], [156,312], [157,312], [158,312], [159,312], [160,312], [161,312], [162,312], [163,312], [164,312], [165,312], [166,312], [167,312], [168,312], [169,312], [170,312], [175,312], [208,312], [235,312], [290,312], [297,312], [ 83,313], [ 93,313], [131,313], [147,313], [176,313], [234,313], [297,313], [ 83,314], [ 93,314], [131,314], [146,314], [233,314], [297,314], [ 83,315], [ 93,315], [131,315], [210,315], [291,315], [297,315], [ 93,316], [131,316], [211,316], [291,316], [297,316], [ 84,317], [ 93,317], [131,317], [212,317], [291,317], [297,317], [ 84,318], [ 93,318], [131,318], [214,318], [297,318], [ 84,319], [ 93,319], [131,319], [215,319], [290,319], [297,319], [ 84,320], [ 93,320], [131,320], [216,320], [297,320], [ 84,321], [131,321], [217,321], [290,321], [297,321], [ 84,322], [131,322], [218,322], [ 84,323], [ 94,323], [131,323], [219,323], [288,323], [290,323], [298,323], [ 85,324], [ 94,324], [131,324], [220,324], [284,324], [285,324], [286,324], [299,324], [ 85,325], [131,325], [221,325], [265,325], [266,325], [267,325], [268,325], [269,325], [270,325], [271,325], [272,325], [273,325], [274,325], [275,325], [276,325], [280,325], [282,325], [300,325], [303,325], [ 85,326], [ 95,326], [131,326], [221,326], [252,326], [253,326], [254,326], [255,326], [256,326], [257,326], [258,326], [259,326], [260,326], [261,326], [262,326], [263,326], [264,326], [301,326], [303,326], [ 85,327], [ 97,327], [ 98,327], [ 99,327], [131,327], [247,327], [248,327], [280,327], [ 85,328], [ 95,328], [101,328], [102,328], [103,328], [131,328], [223,328], [224,328], [225,328], [226,328], [227,328], [228,328], [229,328], [230,328], [231,328], [232,328], [233,328], [234,328], [235,328], [236,328], [237,328], [244,328], [280,328], [303,328], [ 85,329], [105,329], [106,329], [107,329], [131,329], [217,329], [218,329], [280,329], [304,329], [ 85,330], [109,330], [110,330], [111,330], [131,330], [202,330], [203,330], [204,330], [205,330], [206,330], [207,330], [208,330], [209,330], [210,330], [211,330], [215,330], [245,330], [280,330], [305,330], [ 85,331], [112,331], [113,331], [114,331], [115,331], [189,331], [190,331], [191,331], [192,331], [193,331], [194,331], [195,331], [196,331], [197,331], [198,331], [199,331], [212,331], [214,331], [245,331], [280,331], [116,332], [117,332], [118,332], [119,332], [177,332], [178,332], [179,332], [180,332], [181,332], [182,332], [183,332], [184,332], [185,332], [186,332], [187,332], [213,332], [280,332], [305,332], [307,332], [308,332], [309,332], [ 85,333], [ 86,333], [120,333], [121,333], [165,333], [166,333], [167,333], [168,333], [169,333], [170,333], [171,333], [172,333], [173,333], [174,333], [246,333], [280,333], [289,333], [311,333], [312,333], [313,333], [ 95,334], [123,334], [150,334], [151,334], [152,334], [153,334], [154,334], [160,334], [161,334], [162,334], [212,334], [246,334], [289,334], [314,334], [316,334], [ 95,335], [128,335], [129,335], [130,335], [131,335], [135,335], [136,335], [137,335], [138,335], [139,335], [140,335], [141,335], [142,335], [143,335], [144,335], [145,335], [146,335], [147,335], [148,335], [149,335], [157,335], [158,335], [212,335], [246,335], [289,335], [ 85,336], [ 95,336], [124,336], [157,336], [212,336], [280,336], [315,336], [ 85,337], [ 95,337], [159,337], [212,337], [247,337], [280,337], [299,337], [ 85,338], [ 96,338], [123,338], [212,338], [247,338], [280,338], [300,338], [ 96,339], [123,339], [158,339], [247,339], [280,339], [289,339], [291,339], [301,339], [315,339], [ 97,340], [123,340], [159,340], [211,340], [247,340], [280,340], [302,340], [ 98,341], [123,341], [159,341], [211,341], [247,341], [280,341], [303,341], [313,341], [316,341], [ 83,342], [ 99,342], [122,342], [211,342], [281,342], [304,342], [308,342], [309,342], [310,342], [311,342], [312,342], [ 82,343], [100,343], [122,343], [160,343], [211,343], [213,343], [246,343], [248,343], [281,343], [305,343], [101,344], [122,344], [160,344], [281,344], [304,344], [ 81,345], [102,345], [122,345], [216,345], [243,345], [281,345], [304,345], [ 80,346], [102,346], [123,346], [161,346], [218,346], [219,346], [239,346], [240,346], [241,346], [242,346], [281,346], [304,346], [103,347], [123,347], [161,347], [220,347], [222,347], [223,347], [224,347], [225,347], [226,347], [235,347], [236,347], [237,347], [238,347], [281,347], [304,347], [ 79,348], [103,348], [124,348], [161,348], [229,348], [230,348], [231,348], [232,348], [233,348], [281,348], [304,348], [ 78,349], [104,349], [125,349], [160,349], [221,349], [281,349], [287,349], [289,349], [304,349], [ 78,350], [104,350], [126,350], [127,350], [160,350], [162,350], [231,350], [281,350], [304,350], [ 77,351], [104,351], [129,351], [130,351], [131,351], [157,351], [220,351], [231,351], [288,351], [ 77,352], [133,352], [134,352], [151,352], [152,352], [153,352], [154,352], [155,352], [220,352], [231,352], [280,352], [288,352], [303,352], [105,353], [137,353], [144,353], [146,353], [148,353], [149,353], [220,353], [231,353], [280,353], [288,353], [303,353], [ 76,354], [105,354], [220,354], [231,354], [280,354], [288,354], [295,354], [303,354], [ 76,355], [106,355], [135,355], [146,355], [220,355], [231,355], [280,355], [288,355], [295,355], [303,355], [ 76,356], [107,356], [135,356], [220,356], [231,356], [280,356], [288,356], [295,356], [302,356], [108,357], [135,357], [220,357], [231,357], [280,357], [295,357], [302,357], [ 75,358], [112,358], [135,358], [146,358], [219,358], [231,358], [280,358], [295,358], [302,358], [ 75,359], [112,359], [135,359], [146,359], [219,359], [230,359], [280,359], [288,359], [294,359], [301,359], [ 75,360], [ 97,360], [110,360], [135,360], [146,360], [219,360], [230,360], [281,360], [288,360], [301,360], [ 75,361], [ 98,361], [135,361], [146,361], [219,361], [230,361], [282,361], [283,361], [284,361], [285,361], [286,361], [287,361], [ 75,362], [ 99,362], [101,362], [111,362], [135,362], [146,362], [219,362], [230,362], [280,362], [299,362], [ 75,363], [110,363], [134,363], [146,363], [219,363], [230,363], [295,363], [296,363], [297,363], [298,363], [ 75,364], [101,364], [134,364], [146,364], [219,364], [230,364], [ 75,365], [104,365], [105,365], [106,365], [107,365], [108,365], [134,365], [146,365], [ 75,366], [134,366], [229,366], [230,366], [ 75,367], [134,367], [145,367], [ 89,368], [ 97,368], [134,368], [145,368], [ 76,369], [ 82,369], [ 97,369], [134,369], [145,369], [ 76,370], [ 82,370], [ 88,370], [ 98,370], [134,370], [145,370], [225,370], [226,370], [ 76,371], [ 82,371], [ 88,371], [ 89,371], [ 98,371], [134,371], [145,371], [219,371], [ 76,372], [ 82,372], [ 98,372], [145,372], [219,372], [ 77,373], [ 89,373], [ 98,373], [145,373], [227,373], [ 77,374], [ 83,374], [ 89,374], [ 98,374], [133,374], [145,374], [227,374], [ 78,375], [ 89,375], [133,375], [145,375], [219,375], [220,375], [ 83,376], [ 99,376], [133,376], [145,376], [219,376], [227,376], [ 81,377], [ 83,377], [ 99,377], [133,377], [226,377], [ 82,378], [ 89,378], [ 99,378], [133,378], [144,378], [219,378], [ 79,379], [ 80,379], [ 99,379], [145,379], [219,379], [226,379], [ 90,380], [ 99,380], [218,380], [ 90,381], [134,381], [225,381], [227,381], [ 92,382], [ 94,382], [ 95,382], [ 96,382], [ 97,382], [134,382], [217,382], [144,384], [216,384], [134,385], [136,385], [141,385], [216,385], [134,386], [143,386], [216,386], [227,386], [134,387], [142,387], [216,387], [227,387], [134,388], [216,388], [227,388], [134,389], [216,389], [134,390], [142,390], [215,390], [134,391], [142,391], [215,391], [226,391], [135,392], [226,392], [133,393], [216,393], [144,394], [214,394], [227,394], [132,395], [144,395], [218,395], [219,395], [223,395], [225,395], [228,395], [132,396], [221,396], [222,396], [132,397], [209,397], [132,398], [144,398], [209,398], [210,398], [248,398], [249,398], [250,398], [251,398], [252,398], [253,398], [254,398], [132,399], [144,399], [232,399], [244,399], [245,399], [233,400], [252,400], [257,400], [131,401], [208,401], [240,401], [258,401], [259,401], [131,402], [208,402], [239,402], [131,403], [143,403], [208,403], [131,404], [143,404], [208,404], [254,404], [131,405], [143,405], [208,405], [254,405], [255,405], [260,405], [131,406], [143,406], [208,406], [260,406], [143,407], [208,407], [247,407], [253,407], [127,408], [134,408], [144,408], [248,408], [249,408], [250,408], [260,408], [126,409], [136,409], [137,409], [138,409], [139,409], [140,409], [144,409], [210,409], [260,409], [210,410], [260,410], [260,411], [123,412], [211,412], [259,412], [211,413], [122,414], [166,414], [167,414], [168,414], [169,414], [211,414], [258,414], [122,415], [147,415], [164,415], [257,415], [122,416], [149,416], [161,416], [162,416], [164,416], [171,416], [230,416], [255,416], [122,417], [150,417], [159,417], [173,417], [212,417], [215,417], [223,417], [225,417], [232,417], [235,417], [236,417], [237,417], [251,417], [252,417], [253,417], [122,418], [152,418], [153,418], [154,418], [159,418], [210,418], [217,418], [218,418], [223,418], [225,418], [240,418], [241,418], [242,418], [243,418], [244,418], [245,418], [246,418], [247,418], [248,418], [249,418], [122,419], [174,419], [122,420], [156,420], [174,420], [122,421], [174,421], [123,422], [174,422], [123,423], [165,423], [124,424], [161,424], [162,424], [163,424], [124,425], [174,425], [124,426], [174,426], [124,427], [174,427], [125,429], [125,430], [143,430], [126,431], [127,431], [145,431], [148,431], [171,431], [124,432], [128,432], [129,432], [143,432], [150,432], [170,432], [151,433], [152,433], [168,433], [154,434], [155,434], [165,434], [166,434], [158,435], [159,435], [160,435], [161,435], [162,435]]
cities = np.array(cities)

def ConnectSubgraphs(G):
    sub_graphs = nx.connected_component_subgraphs(G)
    # print(list(sub_graphs))
    # For each subgraph, connect it to the closest node in a different subgraph
    for i, sg in enumerate(sub_graphs):
        # Find closest node
        no = np.array(list(sg.nodes()))
        # print(len(no))
        mindist = 10000000
        minN = 0 # Node in this subgraph closest to any other node in a different graph
        # Don't look at nodes in same subgraph
        a,b = np.meshgrid(no, no)
        d[a,b] =  100000
        A = d[no,:]
        (z, nei) = np.unravel_index(A.argmin(), A.shape)
        minN = no[z]
        # for n in sg.nodes():
        #     # for n2 in sg.nodes():
        #     # d[n, no] = 100000
        #     themin = min(d[n, :])
        #     if themin < mindist:
        #         minN = n
        #         mindist = themin

        # minInd = mindists.index(min(mindists))
        # minN = no[minInd]
        ndists = d[minN, :]
        # nei = ndists.find(min(ndists))+1
        print(minN, nei)
        G.add_edge(minN, nei, weight=A.min())

    return G

d = distance_matrix(cities, cities)
# # # Don't look at self-edges
np.fill_diagonal(d, 100000)

# np.save('d', d)

# d = np.load('d.npy')
print('2')
a1 = np.multiply(d, (d < 30))
print(len(a1 != 0))
np.fill_diagonal(a1, 0)

G = nx.from_numpy_matrix(a1)
G = nx.minimum_spanning_tree(G)

def plotG(G, cities):
    nx.draw(G, dict(zip(range(0, len(cities)), cities)), node_size=.2)
    plt.show()

nx.write_weighted_edgelist(G,"new.adjlist")
T = nx.MultiGraph()
T = nx.read_weighted_edgelist('new.adjlist', nodetype=int, create_using=T)

def CloseDegreeOneNodes(T):
    print('a')
    nodes_one_degree = [v for v, d2 in T.degree() if d2 == 1]
    dOne = d[nodes_one_degree, :]
    print('a2')
    dOne = dOne[:, nodes_one_degree]
    closedOne = dOne < 5
    clipped = np.tril(closedOne)
    pairs = np.argwhere(clipped)
    for p in pairs:
        T.add_edge(nodes_one_degree[p[0]], nodes_one_degree[p[1]])
    return T

def MatchDegOne(T):
    nodes_one_degree = [v for v, d2 in T.degree() if d2 == 1]
    dOne = d[nodes_one_degree, :]
    print('a3')
    dOne = dOne[:, nodes_one_degree]
    row_ind, col_ind = linear_sum_assignment(dOne)

    added = []
    for j in range(0,len(nodes_one_degree)):
        if j == col_ind[col_ind[j]]:
            if not (j in added or col_ind[j] in added):
                added.append(j)
                added.append(col_ind[j])
                T.add_edge(nodes_one_degree[j], nodes_one_degree[col_ind[j]])
    return T


def FixDegreeOneNodes(T):
    print('b')
    nodes_one_degree = [v for v, d2 in T.degree() if d2 == 1]
    # Any degree-one node gets a duplicate edge
    print('b2')
    for one in nodes_one_degree:
        bors = list(T.neighbors(one))
        T.add_edge(one, bors[0])

    return T

def FixEasyOddDegree(T):
    print('c')
    nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
    # Any odd-degree node with an odd-degree neighbor gets a duplicate edge
    print('c2')
    for odd in nodes_odd_degree:
        bors = list(T.neighbors(odd))
        for b in bors:
            if b in nodes_odd_degree:
                nodes_odd_degree.remove(b)
                T.add_edge(odd, b)
                break

    return T

# subgraphs = nx.connected_component_subgraphs(T)

# if len(list(subgraphs)) != 1:
#     print('subgraphs')
plotG(T, cities)

T = CloseDegreeOneNodes(T)
# T = MatchDegOne(T)

plotG(T, cities)

T = FixDegreeOneNodes(T)

T = FixEasyOddDegree(T)

print('3')

# # Pair up each odd degree node such that 
# # the total cost to connect each pair (through other edges) is minimized
# # Add paths btwn pairs, edges increase degree of intermediate nodes by 2

def CreateLMat(T):
    nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
    print(len(nodes_odd_degree))
    lMat = np.ones((len(nodes_odd_degree), len(T.nodes())))*100000
    i = 0
    for odd in nodes_odd_degree:
        length=nx.single_source_dijkstra_path_length(T,odd)
        v = length.values()
        k = length.keys()
        Z = [x for _,x in sorted(zip(k,v))]
        lMat[i, :] = Z
        i += 1
    lMat = lMat[:, nodes_odd_degree]
    np.fill_diagonal(lMat, 100000)
    return lMat

lMat = CreateLMat(T)
print('3A')

def LinSum(T, lMat):
    nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
    row_ind, col_ind = linear_sum_assignment(lMat)

    added = []
    for j in range(0,len(nodes_odd_degree)):
        if j == col_ind[col_ind[j]]:
            if not (j in added or col_ind[j] in added):
                added.append(j)
                added.append(col_ind[j])
                path=nx.dijkstra_path(T,nodes_odd_degree[j], nodes_odd_degree[col_ind[j]])
                # print(path)
                T.add_path(path)
    return T

T = LinSum(T, lMat)

nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
print(len(nodes_odd_degree),sorted(nodes_odd_degree))
print('4')


lMat = CreateLMat(T)

def RANSAC(T):
    nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
    nOdd = len(nodes_odd_degree)

    # randomly split nodes_odd_degree into 2 halves
    # linsumassign row vs column, compare

    bestSum = 100000000
    bestL = []
    bestR = []
    for x in range(0, 300):
        oddNodes = np.random.choice(nOdd, nOdd, replace=False)
        L, R = oddNodes[:int(nOdd/2)], oddNodes[int(nOdd/2):]
        submat = lMat[L, :]
        submat = submat[:, R]

        r, c = linear_sum_assignment(submat)
        thisSum = submat[r, c].sum()
        if thisSum < bestSum:
            print(thisSum)
            bestSum = thisSum
            bestL = L
            bestR = R

    for j in range(0,len(L)):
        path=nx.dijkstra_path(T,nodes_odd_degree[bestL[j]], nodes_odd_degree[bestR[j]])
        T.add_path(path)
    return T

T = RANSAC(T)
plotG(T, cities)

print(len(list(T.edges())))
nodes_odd_degree = [v for v, d2 in T.degree() if d2 % 2 == 1]
stops = np.array([u for u, v in nx.eulerian_circuit(T)])
print(len(stops))

def RemoveStutter(stops):
    diff2 = stops[:-2] - stops[2:]
    adiff2 = np.array(diff2[:-1])
    bdiff2 = np.array(diff2[1:])
    rem = np.logical_not(np.logical_and(adiff2 == 0, bdiff2 == 0))
    rem = np.insert(rem, 0, [True, True, True], axis=0)
    stops = stops[rem]
    return stops
print(len(stops))
stops = RemoveStutter(stops)

def RemoveColinear(pa):

    spa = np.array(pa[1:, :])
    # spa.append([0, 0])
    spa = np.append(spa, [[0, 0]], axis=0)
    dpa = pa - spa
    sdpa = dpa[1:, :]
    # sdpa.append([0, 0])
    sdpa = np.append(sdpa, [[0, 0]], axis=0)
    ddpa = dpa - sdpa
    q = np.sum(ddpa, axis=1) != 0
    print(len(q), np.sum(q))
    return pa[q]

print(len(stops))
out = RemoveColinear(cities[stops])
print(len(out))
# print(cities[stops])
np.set_printoptions(threshold=sys.maxsize)
print(np.array2string(out, separator=','))